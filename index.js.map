{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst API_KEY = \"48879353-852d93d42efc708c69048a712\";\nconst BASE_URL = \"https://pixabay.com/api/\";\nconst PER_PAGE = 40; // Changed to 40 (4 columns × 10 rows)\n\nexport async function fetchImages(query, page = 1) {\n  try {\n    const response = await axios.get(BASE_URL, {\n      params: {\n        key: API_KEY,\n        q: query,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n        page: page,\n        per_page: PER_PAGE,\n      },\n    });\n    return response.data;\n  } catch (error) {\n    throw error;\n  }\n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\n// Винесено створення lightbox у глобальний код\nlet lightbox = new SimpleLightbox('.gallery .gallery-item a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport function renderImages(images, isNewSearch = true) {\n  const gallery = document.querySelector(\".gallery\");\n  \n  if (isNewSearch) {\n    // Перевіряємо чи існує lightbox і знищуємо його перед очищенням галереї\n    if (lightbox) {\n      lightbox.destroy();\n    }\n    gallery.innerHTML = '';\n  }\n  \n  if (images.length === 0) {\n    gallery.innerHTML = '<p>No images found. Try another search.</p>';\n    return;\n  }\n\n  const markup = images\n    .map(\n      (img) => `\n      <div class=\"gallery-item\">\n        <a href=\"${img.largeImageURL}\">\n          <img src=\"${img.webformatURL}\" alt=\"${img.tags}\" loading=\"lazy\"/>\n        </a>\n        <div class=\"info\">\n          <p><b>Likes:</b> ${img.likes}</p>\n          <p><b>Views:</b> ${img.views}</p>\n          <p><b>Comments:</b> ${img.comments}</p>\n          <p><b>Downloads:</b> ${img.downloads}</p>\n        </div>\n      </div>`\n    )\n    .join(\"\");\n\n  if (isNewSearch) {\n    gallery.innerHTML = markup;\n  } else {\n    gallery.insertAdjacentHTML('beforeend', markup);\n  }\n\n  // Створюємо новий екземпляр або оновлюємо існуючий\n  lightbox = new SimpleLightbox('.gallery .gallery-item a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n  \n  document.querySelector('main').classList.add('visible');\n  document.querySelector('header').classList.add('searched');\n}","import { fetchImages } from \"./js/pixabay-api.js\";\nimport { renderImages } from \"./js/render-functions.js\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nlet currentPage = 1;\nlet currentQuery = '';\nconst loadMoreBtn = document.querySelector('.load-more');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\n\ndocument.getElementById(\"search-form\").addEventListener(\"submit\", async (event) => {\n  event.preventDefault();\n  currentPage = 1;\n  \n  // Очищаємо галерею (тепер це буде оброблятися в renderImages з параметром isNewSearch=true)\n  // gallery.innerHTML = ''; \n  \n  loadMoreBtn.style.display = 'none';\n  \n  const query = document.getElementById(\"search-input\").value.trim();\n  if (!query) {\n    iziToast.warning({\n      message: \"Please enter a search term!\",\n    });\n    return;\n  }\n\n  currentQuery = query;\n  await fetchAndRender();\n});\n\nloadMoreBtn.addEventListener(\"click\", async () => {\n  currentPage += 1;\n  await fetchAndRender(false);\n});\n\nasync function fetchAndRender(isNewSearch = true) {\n  loader.style.display = 'block';\n  \n  try {\n    const data = await fetchImages(currentQuery, currentPage);\n    \n    if (data.hits.length === 0 && isNewSearch) {\n      iziToast.info({\n        message: \"Sorry, there are no images matching your search query.\",\n      });\n      return;\n    }\n\n    renderImages(data.hits, isNewSearch);\n\n    // Використовуємо значення PER_PAGE=40 з pixabay-api.js\n    if (currentPage * 40 >= data.totalHits) {\n      loadMoreBtn.style.display = 'none';\n      if (!isNewSearch) {\n        iziToast.info({\n          message: \"We're sorry, but you've reached the end of search results.\",\n        });\n      }\n    } else {\n      loadMoreBtn.style.display = 'block';\n    }\n\n    if (isNewSearch && data.totalHits > 0) {\n      iziToast.success({\n        message: `Hooray! We found ${data.totalHits} images.`,\n      });\n    }\n\n    if (!isNewSearch) {\n      const { height: cardHeight } = gallery.firstElementChild.getBoundingClientRect();\n      window.scrollBy({\n        top: cardHeight * 2,\n        behavior: \"smooth\",\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      message: \"Failed to fetch images. Please try again later.\",\n    });\n  } finally {\n    loader.style.display = 'none';\n  }\n}"],"names":["API_KEY","BASE_URL","PER_PAGE","fetchImages","query","page","axios","error","lightbox","SimpleLightbox","renderImages","images","isNewSearch","gallery","markup","img","currentPage","currentQuery","loadMoreBtn","loader","event","iziToast","fetchAndRender","data","cardHeight"],"mappings":"owBAEA,MAAMA,EAAU,qCACVC,EAAW,2BACXC,EAAW,GAEV,eAAeC,EAAYC,EAAOC,EAAO,EAAG,CACjD,GAAI,CAYF,OAXiB,MAAMC,EAAM,IAAIL,EAAU,CACzC,OAAQ,CACN,IAAKD,EACL,EAAGI,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMC,EACN,SAAUH,CACX,CACP,CAAK,GACe,IACjB,OAAQK,EAAO,CACd,MAAMA,CACP,CACH,CCnBA,IAAIC,EAAW,IAAIC,EAAe,2BAA4B,CAC5D,aAAc,MACd,aAAc,GAChB,CAAC,EAEM,SAASC,EAAaC,EAAQC,EAAc,GAAM,CACvD,MAAMC,EAAU,SAAS,cAAc,UAAU,EAUjD,GARID,IAEEJ,GACFA,EAAS,QAAO,EAElBK,EAAQ,UAAY,IAGlBF,EAAO,SAAW,EAAG,CACvBE,EAAQ,UAAY,8CACpB,MACD,CAED,MAAMC,EAASH,EACZ,IACEI,GAAQ;AAAA;AAAA,mBAEIA,EAAI,aAAa;AAAA,sBACdA,EAAI,YAAY,UAAUA,EAAI,IAAI;AAAA;AAAA;AAAA,6BAG3BA,EAAI,KAAK;AAAA,6BACTA,EAAI,KAAK;AAAA,gCACNA,EAAI,QAAQ;AAAA,iCACXA,EAAI,SAAS;AAAA;AAAA,aAGzC,EACA,KAAK,EAAE,EAENH,EACFC,EAAQ,UAAYC,EAEpBD,EAAQ,mBAAmB,YAAaC,CAAM,EAIhDN,EAAW,IAAIC,EAAe,2BAA4B,CACxD,aAAc,MACd,aAAc,GAClB,CAAG,EAED,SAAS,cAAc,MAAM,EAAE,UAAU,IAAI,SAAS,EACtD,SAAS,cAAc,QAAQ,EAAE,UAAU,IAAI,UAAU,CAC3D,CCnDA,IAAIO,EAAc,EACdC,EAAe,GACnB,MAAMC,EAAc,SAAS,cAAc,YAAY,EACjDL,EAAU,SAAS,cAAc,UAAU,EAC3CM,EAAS,SAAS,cAAc,SAAS,EAE/C,SAAS,eAAe,aAAa,EAAE,iBAAiB,SAAU,MAAOC,GAAU,CACjFA,EAAM,eAAc,EACpBJ,EAAc,EAKdE,EAAY,MAAM,QAAU,OAE5B,MAAMd,EAAQ,SAAS,eAAe,cAAc,EAAE,MAAM,OAC5D,GAAI,CAACA,EAAO,CACViB,EAAS,QAAQ,CACf,QAAS,6BACf,CAAK,EACD,MACD,CAEDJ,EAAeb,EACf,MAAMkB,EAAc,CACtB,CAAC,EAEDJ,EAAY,iBAAiB,QAAS,SAAY,CAChDF,GAAe,EACf,MAAMM,EAAe,EAAK,CAC5B,CAAC,EAED,eAAeA,EAAeV,EAAc,GAAM,CAChDO,EAAO,MAAM,QAAU,QAEvB,GAAI,CACF,MAAMI,EAAO,MAAMpB,EAAYc,EAAcD,CAAW,EAExD,GAAIO,EAAK,KAAK,SAAW,GAAKX,EAAa,CACzCS,EAAS,KAAK,CACZ,QAAS,wDACjB,CAAO,EACD,MACD,CAsBD,GApBAX,EAAaa,EAAK,KAAMX,CAAW,EAG/BI,EAAc,IAAMO,EAAK,WAC3BL,EAAY,MAAM,QAAU,OACvBN,GACHS,EAAS,KAAK,CACZ,QAAS,4DACnB,CAAS,GAGHH,EAAY,MAAM,QAAU,QAG1BN,GAAeW,EAAK,UAAY,GAClCF,EAAS,QAAQ,CACf,QAAS,oBAAoBE,EAAK,SAAS,UACnD,CAAO,EAGC,CAACX,EAAa,CAChB,KAAM,CAAE,OAAQY,CAAU,EAAKX,EAAQ,kBAAkB,wBACzD,OAAO,SAAS,CACd,IAAKW,EAAa,EAClB,SAAU,QAClB,CAAO,CACF,CACF,MAAe,CACdH,EAAS,MAAM,CACb,QAAS,iDACf,CAAK,CACL,QAAY,CACRF,EAAO,MAAM,QAAU,MACxB,CACH"}